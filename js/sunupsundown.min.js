var sunupsundown=function(){function getLatLng(){navigator.geolocation.getCurrentPosition(geoSuccess,geoError)}function geoError(){console.log("Sorry, your current location cannot be found.")}function geoSuccess(location){var loc={lat:location.coords.latitude,lng:location.coords.longitude},evt=document.createEvent("CustomEvent");evt.initCustomEvent("locationReported",!0,!0,loc),window.dispatchEvent(evt)}function buildXHR(lat,lng){var currentDate=new Date,day=currentDate.getDate(),mon=currentDate.getMonth(),utcOffset=createOffset(currentDate);return"http://www.earthtools.org/sun/"+lat+"/"+lng+"/"+day+"/"+mon+"/"+utcOffset+"/0"}function createOffset(date){var sign=date.getTimezoneOffset()>0?"-":"";return sign+Math.floor(Math.abs(date.getTimezoneOffset())/60)}function getSunUpSunDown(urlToFetch){request=new XMLHttpRequest,request.open("GET",urlToFetch,!0),request.onload=function(){console.log(request.status>=200&&request.status<400?request.responseText:"Sorry, the EarthTools service returned an error: "+request.status)},request.onerror=function(){console.log("Sorry, there was an error establishing a connection to the EarthTools service.")},request.send()}getLatLng(),window.addEventListener("locationReported",function(evt){var urlToFetch=buildXHR(evt.detail.lat,evt.detail.lng);getSunUpSunDown(urlToFetch)},!1)}();